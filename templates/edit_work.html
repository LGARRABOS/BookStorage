{% extends "base.html" %}
{% block title %}Modifier {{ work.title }}{% endblock %}
{% block custom_css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/add_work.css') }}">
{% endblock %}
{% block content %}
<section class="page-section">
  <header class="section-header">
    <h1>Modifier une œuvre</h1>
    <p>Actualisez les informations de cette œuvre pour garder votre bibliothèque à jour.</p>
  </header>

  <form method="POST" enctype="multipart/form-data" class="form-layout card">
    <div class="form-grid">
      <div class="form-field">
        <label for="title">Titre</label>
        <input id="title" type="text" name="title" maxlength="60" value="{{ work.title }}" required>
      </div>

      <div class="form-field">
        <label for="chapter">Chapitre actuel</label>
        <input id="chapter" type="number" name="chapter" min="0" value="{{ work.chapter }}">
      </div>

      <div class="form-field">
        <label for="status">Statut de lecture</label>
        <select id="status" name="status">
          {% for status in statuses %}
          <option value="{{ status }}" {% if work.status == status %}selected{% endif %}>{{ status }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="form-field">
        <label for="reading_type">Type de lecture</label>
        <select id="reading_type" name="reading_type" required>
          {% for reading_type in reading_types %}
          <option value="{{ reading_type }}" {% if work.reading_type == reading_type %}selected{% endif %}>{{ reading_type }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="form-field">
        <label for="link">Lien vers la ressource</label>
        <input id="link" type="url" name="link" placeholder="https://..." value="{{ work.link }}">
      </div>

      <div class="form-field">
        <label for="image">Image de couverture</label>
        <input id="image" type="file" name="image" accept="image/*">
        <p class="field-hint">Laissez vide pour conserver l'image actuelle.</p>
        {% set image_url = work_image_url(work.image_path) %}
        {% if image_url %}
        <div class="current-cover">
          <span>Image actuelle :</span>
          <img src="{{ image_url }}" alt="Image actuelle de {{ work.title }}">
        </div>
        {% endif %}
      </div>
    </div>

    <div class="form-actions">
      <a class="btn btn-secondary" href="{{ url_for('dashboard') }}">Annuler</a>
      <button type="submit" class="btn btn-primary">Enregistrer les modifications</button>
    </div>
  </form>
</section>
{% endblock %}
